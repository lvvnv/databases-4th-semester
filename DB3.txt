1 Ќайти и вывести на экран название продуктов и название категорий товаров, к
которым относитс€ этот продукт, с учетом того, что в выборку попадут только
товары с цветом Red и ценой не менее 100
SELECT P.Name, PC.Name AS 'Category'
FROM [Production].[Product] AS P INNER JOIN
[Production].[ProductSubcategory] AS PS
ON P.ProductSubcategoryID=PS.ProductSubcategoryID INNER JOIN
[Production].[ProductCategory] AS PC
ON PS.ProductCategoryID=PC.ProductCategoryID
WHERE P.Color='Red' AND P.ListPrice>=100

2 ¬ывести на экран названи€ подкатегорий с совпадающими именами.
SELECT PS.Name
FROM [Production].[ProductSubcategory] AS PS
GROUP BY PS.Name
HAVING COUNT(PS.ProductSubcategoryID)>1

3 ¬ывести на экран название категорий и количество товаров в данной
категории.
SELECT PC.Name AS 'Category', COUNT(P.ProductID) AS 'Amount'
FROM [Production].[Product] AS P FULL JOIN
[Production].[ProductSubcategory] AS PS
ON P.ProductSubcategoryID=PS.ProductSubcategoryID INNER JOIN
[Production].[ProductCategory] AS PC
ON PS.ProductCategoryID=PC.ProductCategoryID
GROUP BY PC.Name

4 ¬ывести на экран название подкатегории, а также количество товаров в данной
подкатегории с учетом ситуации, что могут существовать подкатегории с
одинаковыми именами.
SELECT PS.Name, COUNT(P.ProductID) AS 'Amount'
FROM [Production].[Product] AS P INNER JOIN
[Production].[ProductSubcategory] AS PS
ON P.ProductSubcategoryID=PS.ProductSubcategoryID 
GROUP BY PS.ProductSubcategoryID, PS.Name

5 ¬ывести на экран название первых трех подкатегорий с небольшим
количеством товаров.
SELECT TOP 3 PS.Name
FROM [Production].[Product] AS P INNER JOIN
[Production].[ProductSubcategory] AS PS
ON P.ProductSubcategoryID=PS.ProductSubcategoryID 
GROUP BY PS.Name
ORDER BY COUNT(P.ProductID)

6 ¬ывести на экран название подкатегории и максимальную цену продукта с
цветом Red в этой подкатегории.
SELECT PS.Name, MAX(P.ListPrice) AS 'Price'
FROM [Production].[Product] AS P INNER JOIN
[Production].[ProductSubcategory] AS PS
ON P.ProductSubcategoryID=PS.ProductSubcategoryID 
WHERE P.Color='Red'
GROUP BY PS.Name

7 ¬ывести на экран название поставщика и количество товаров, которые он
поставл€ет.
SELECT V.Name, COUNT(P.ProductID) AS 'Amount'
FROM [Production].[Product] AS P INNER JOIN
[Purchasing].[ProductVendor] AS PV
ON P.ProductID=PV.ProductID INNER JOIN
[Purchasing].[Vendor] AS V
ON PV.BusinessEntityID=V.BusinessEntityID
GROUP BY V.Name

8 ¬ывести на экран название товаров, которые поставл€ютс€ более чем одним
поставщиком.
SELECT P.Name
FROM [Production].[Product] AS P INNER JOIN
[Purchasing].[ProductVendor] AS PV
ON P.ProductID=PV.ProductID INNER JOIN
[Purchasing].[Vendor] AS V
ON PV.BusinessEntityID=V.BusinessEntityID
GROUP BY P.Name
HAVING COUNT(PV.BusinessEntityID)>1

9 ¬ывести на экран название самого продаваемого товара.
SELECT TOP 1 WITH TIES P.Name
FROM [Sales].[SalesOrderDetail] AS S INNER JOIN
[Production].[Product] AS P
ON S.ProductID=P.ProductID
GROUP BY P.Name
ORDER BY COUNT(*)

10 ¬ывести на экран название категории, товары из которой продаютс€ наиболее
активно.
SELECT TOP 1 WITH TIES PC.Name
FROM [Sales].[SalesOrderDetail] AS S INNER JOIN
[Production].[Product] AS P
ON S.ProductID=P.ProductID INNER JOIN
[Production].[ProductSubcategory] AS PS
ON P.ProductSubcategoryID=PS.ProductSubcategoryID INNER JOIN
[Production].[ProductCategory] AS PC
ON PS.ProductCategoryID=PC.ProductCategoryID
GROUP BY PC.Name
ORDER BY COUNT(S.SalesOrderDetailID)

11 ¬ывести на экран названи€ категорий, количество подкатегорий и количество
товаров в них.
SELECT PC.Name, COUNT(DISTINCT PS.ProductSubcategoryID) AS 'Subcategories', COUNT(P.ProductID) AS 'Products'
FROM [Production].[Product] AS P INNER JOIN
[Production].[ProductSubcategory] AS PS
ON P.ProductSubcategoryID=PS.ProductSubcategoryID INNER JOIN
[Production].[ProductCategory] AS PC
ON PS.ProductCategoryID=PC.ProductCategoryID
GROUP BY PC.Name

12 ¬ывести на экран номер кредитного рейтинга и количество товаров,
поставл€емых компани€ми, имеющими этот кредитный рейтинг.
SELECT V.CreditRating, COUNT(DISTINCT PV.ProductID) AS 'Amount'
FROM [Purchasing].[ProductVendor] AS PV INNER JOIN
[Purchasing].[Vendor] AS V
ON PV.BusinessEntityID=V.BusinessEntityID
GROUP BY V.CreditRating